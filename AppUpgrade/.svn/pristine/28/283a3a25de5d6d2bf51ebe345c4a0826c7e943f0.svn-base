<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" href="../../css/mui.picker.min.css" />
		<style type="text/css">
			.shuru {
				border-bottom: 1px solid #b2b2b2;
				line-height: 56px;
			}
			
			.shuru input {
				border: none;
				/*outline-style: none;*/
				display: inline-block;
			}
			
			.shuru span {
				display: inline-block;
			}
			
			html,
			body {
				width: 100%;
			}
			
			.tuijianruzhi {
				width: 100%;
				top: 10px
			}
		</style>
	</head>

	<body>
		<header id="header" class="mui-bar mui-bar-nav" style="background-color: #fff;">
			<a style="color: #5CA8FC;" class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 id="title_company" class="mui-title" style="color: #5CA8FC;">推荐好友</h1>
		</header>
		<div class="" style="margin-top: 12%;">
		</div>
		<!--展示推荐入职-->
		<div class="" style="width: 95%;margin: 0 auto;border-bottom: 2px solid #e6e6e6;padding: 10px 10px;font-size: 13px;font-size: 12px; font-family: '微软雅黑';background-color: #FFFFFF;">
			<span style="display: inline-block;margin-left: 1%;">排名</span>
			<span style="display: inline-block;margin-left: 23%;">姓名</span>
			<!--<span style="display: inline-block;margin-left: 38%;">推荐人数</span>-->
			<span style="display: inline-block;margin-left: 35%;">奖励金额</span>
		</div>
		<ul id="mytuijianruzhi" style="list-style: none;width: 95%;margin: 0 auto;font-size: 12px; font-family: '微软雅黑';background-color: #FFFFFF; margin-left: 2.5%; padding: 0;">
			<!--<li style="border-bottom: 1px solid #B6B6B6;">
				<img src="images/huang0.png" style="width: 30px; vertical-align: middle;" />
				<img src="https://www.zhizhaojob.cn/data/upload/avatar/1704/20/8988a4f316feefe7d8563495ff8b7f8c.jpg" style="width: 40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />
				<span style="display: inline-block;margin-left: 5%;">sjsj的朋友</span>
				<span style="display: inline-block;margin-left: 10%;">0</span>
				<span style="display: inline-block;margin-left: 18%;">0</span>
			</li>-->
			<!--<li style="border-bottom: 1px solid #B6B6B6;">
				<img src="images/huang1.png" style="width: 30px; vertical-align: middle;" />
				<img src="https://www.zhizhaojob.cn/data/upload/avatar/1704/20/8988a4f316feefe7d8563495ff8b7f8c.jpg" style=" width: 40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />
				<span style="display: inline-block;margin-left: 5%;">wod</span>
				<span style="display: inline-block;margin-left: 10%;">0</span>
				<span style="display: inline-block;margin-left: 18%;">1</span>
			</li>-->
			<!--<li style="border-bottom: 1px solid #B6B6B6;">
				<img src="images/huang2.png" style="width: 30px; vertical-align: middle;" />
				<img src="https://www.zhizhaojob.cn/data/upload/avatar/1704/20/8988a4f316feefe7d8563495ff8b7f8c.jpg" style="width: 40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />
				<span style="display: inline-block;margin-left: 5%;">车载的朋友</span>
				<span style="display: inline-block;margin-left: 10%;">0</span>
				<span style="display: inline-block;margin-left: 18%;">2</span>
			</li>-->
			<!--<li style="border-bottom: 1px solid #B6B6B6;">
				<img src="images/huang1.png" style="width: 30px; vertical-align: middle;" />
				<img src="../../images/shenqingguo.png" style=" width: 40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />
				<span style="display: inline-block;margin-left: 5%;">张三三</span>
				<span style="display: inline-block;margin-left: 10%;">111</span>
				<span style="display: inline-block;margin-left: 18%;">1110.00元</span>
			</li>-->
			<!--<div class="" style="border-bottom: 1px solid #B6B6B6;">
				<img src="images/huang1.png" style="width: 30px; vertical-align: middle;" />
				<img src="../../images/shenqingguo.png" style=" width: 40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />
				<span style="display: inline-block;margin-left: 5%;">张三三</span>
				<span style="display: inline-block;margin-left: 10%;">111</span>
				<span style="display: inline-block;margin-left: 18%;">1110.00元</span>
			</div>-->
			<!--<div class="" style="border-bottom: 1px solid #B6B6B6;">
				<img src="images/huang2.png" style="width: 30px; vertical-align: middle;" />
				<img src="../../images/shenqingguo.png" style=" width: 40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />
				<span style="display: inline-block;margin-left: 5%;">张三三</span>
				<span style="display: inline-block;margin-left: 10%;">111</span>
				<span style="display: inline-block;margin-left: 18%;">1110.00元</span>
			</div>-->
			<!--<div class="" style="border-bottom: 1px solid #B6B6B6;">
				<img src="images/huang3.png" style="width: 30px; vertical-align: middle;" />
				<img src="../../images/shenqingguo.png" style=" width: 40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />
				<span style="display: inline-block;margin-left: 5%;">张三三</span>
				<span style="display: inline-block;margin-left: 10%;">111</span>
				<span style="display: inline-block;margin-left: 18%;">1110.00元</span>
			</div>-->
		</ul>
		<!--更多-->
		<div id="gengduo" class="" style="text-align: right; font-family: '微软雅黑';font-size: 14px; margin-right: 20px;margin-top: 10px;margin-bottom: 20px;">
			更多
		</div>
		<!--		
<marquee class="tuijianruzhi" style="width: 100%; margin: 0;" direction="up" behavior="scroll" scrollamount="1" scrolldelay="0" loop="-1" width="100%" height="50" bgcolor="#0099FF" hspace="10" vspace="10">			
			<div class="" style=" width: 100%; margin-left: 0; border-top: 2px solid #666666; border-bottom: 2px solid #666666;">
					<span style="display: inline-block; font-size: 20px; margin-left: 5%;">1</span>
					<img src="../../images/shenqingguo.png"style="vertical-align: middle;width: 40px;height: 40px; margin: 3% 0; margin-left: 3%;"/>
					<span style="display: inline-block;margin-left: 20%;">姓名名</span>
					<span style="display: inline-block;margin-left: 20%;">2700元</span>
			</div>
			<div class="" style=" width: 100%; margin-left: 0; border-top: 2px solid #666666; border-bottom: 2px solid #666666;">
					<span style="display: inline-block; font-size: 20px; margin-left: 5%;">1</span>
					<img src="../../images/shenqingguo.png"style="vertical-align: middle;width: 40px;height: 40px; margin: 3% 0; margin-left: 3%;"/>
					<span style="display: inline-block;margin-left: 20%;">姓名名</span>
					<span style="display: inline-block;margin-left: 20%;">2700元</span>
			</div>
</marquee>
<marquee class="mytuijianruzhi" style="width: 100%; margin: 0;" direction="up" behavior="scroll" scrollamount="1" scrolldelay="0" loop="-1" width="100%" height="50" bgcolor="#0099FF" hspace="10" vspace="10">			
			<div class="" style=" width: 100%; margin-left: 0; border-top: 2px solid #666666; border-bottom: 2px solid #666666;">
					<span style="display: inline-block; font-size: 20px; margin-left: 5%;">1</span>
					<img src="../../images/shenqingguo.png"style="vertical-align: middle;width: 40px;height: 40px; margin: 3% 0; margin-left: 3%;"/>
					<span style="display: inline-block;margin-left: 20%;">姓名名</span>
					<span style="display: inline-block;margin-left: 20%;">2700元</span>
			</div>
			<div class="" style=" width: 100%; margin-left: 0; border-top: 2px solid #666666; border-bottom: 2px solid #666666;">
					<span style="display: inline-block; font-size: 20px; margin-left: 5%;">1</span>
					<img src="../../images/shenqingguo.png"style="vertical-align: middle;width: 40px;height: 40px; margin: 3% 0; margin-left: 3%;"/>
					<span style="display: inline-block;margin-left: 20%;">姓名名</span>
					<span style="display: inline-block;margin-left: 20%;">2700元</span>
			</div>
</marquee>-->
		<!--<div class="wotuijian" style="text-align: center; margin-top: 20px;">
			我的推荐
		</div>-->
		<div class="" id="gengduo" style="text-align: right; margin-right: 10px;margin-top: 20px;margin-bottom: 20px;">
			
		</div>
		<div class="hezi" style="border: 1px solid #b2b2b2;padding: 26px 17px;padding-top:0;margin:0px 13px 13px;background-color: #fff;border-radius: 10px;">
			<div class="name shuru mui-clearfix">
				<span style="float: left;width: 80px;font-size: 16px;color: #5CA8FC;">好友姓名：</span>
				<span style="float: right;width: 70%;"><input style="font-size: 16px;margin:0;" font-size: 16px; id="person_phone_name" type="text" placeholder="请填写朋友真实姓名"/></span>
			</div>
			<div class="iphone shuru mui-clearfix">
				<span style="float: left;width: 80px;font-size: 16px;color: #5CA8FC;">好友电话：</span>

				<span style="float: right;width: 70%;position: relative;">
					<input style="font-size: 16px;margin:0;" type="tel" placeholder="请填写朋友手机号码" id="person_phone_number" maxlength="11"/>
					<span id="showUserPickerButton" style="position:absolute;top:17px;right:10px;display: inline-block;width: 25px;height: 25px;background:url(images/txl.png) no-repeat;background-size:25px 25px;"></span>
				</span>
			</div>
			<div class="mess" style="text-align: center;color: #5CA8FC;font-size: 14px; padding-top: 10px; padding-bottom: 10px;">成功推荐好友入职可获得100元奖励</div>
			<div class="l-mess" style="font-size: 12px;text-align: left;margin-left:35px;">
				<span style="color: #5CA8FC;"></span>
				<span style=";">①推荐者符合企业要求</span> <br />
				<span>②入职满7-15天后发放奖励</span><br />
				<span>③需登陆状态下推荐好友，方可领取奖励</span>
			</div>
		</div>
		<!--提交按钮-->
		<div class="" style="text-align: center; margin-top: 20px;">
			<button id="submit_info" style="color: white;border-radius:10px;background-color: #5CA8FC;text-align: center;width: 100px;display:block;margin:0 auto;display: inline-block; padding: 10px 0;">我要推荐</button>
			<div class="" style="width: 40px; display: inline-block;"></div>
			<button id="subcg" style="color: white;border-radius:10px;background-color: #5CA8FC;text-align: center;width: 100px;display:block;margin:0 auto;display: inline-block;padding: 10px 0;">推荐成功</button>
		</div>
		<!--<div style="margin-top:100px;width:37%;margin:0 auto;">
			<img src="../../images/zhizhao.png" alt="" style="width:100%;height:50px;margin:0 auto;" />
		</div>-->
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/mui.picker.min.js"></script>
		<script type="text/javascript">
			mui.init()
			// 准备dom对象
			var showUserPickerButton = document.querySelector('#showUserPickerButton');
			var userPicker = new mui.PopPicker();
			var person_phone_number = document.querySelector('#person_phone_number');
			var person_phone_name = document.querySelector('#person_phone_name');
			var submit_info = document.querySelector('#submit_info');
			var tuijianruzhi = document.querySelector('.tuijianruzhi');
			
			document.addEventListener("plusready", function() {
				// 扩展API加载完毕，现在可以正常调用扩展API
				//				plus.contacts.getAddressBook( plus.contacts.ADDRESSBOOK_PHONE, function( addressbook ) {
				//					// 可通过addressbook进行通讯录操作
				//					alert( "Get address book success!" );
				//				}, function ( e ) {
				//					alert( "Get address book failed: " + e.message );
				//				} );

				// 获取手机上的通讯录信息
				showUserPickerButton.addEventListener('tap', function(event) {
					//提取用户手机联系人 传给数据源contact_arr

					var contact_arr = [];
					plus.contacts.getAddressBook(plus.contacts.ADDRESSBOOK_PHONE, function(addressbook) {
						addressbook.find([], function(contacts) {

							//							alert(contacts);
							for(var i = 0; i < contacts.length; i++) {
								//contact_arr_text是contact_arr数据源中每一个item用于显示的值 此处为联系人名称+手机号
								//这里一定要判断联系人名称不为空 一旦漏判undefined后面所有逻辑都不会执行!!
								if(contacts[i] !== undefined && contacts[i].displayName !== undefined) {
									//判断用户的手机号码不为空时 取手机号码
									if(contacts[i].phoneNumbers[0] !== undefined) {
										var contact_arr_text = contacts[i].displayName + "\t" + contacts[i].phoneNumbers[0].value;
									}
									//若手机号为空 则判断住宅号是否为空 不为空就用住宅号码 若住宅号码也为空 这个用户就不显示了
									else if(contacts[i].phoneNumbers[1] !== undefined) {
										var contact_arr_text = contacts[i].displayName + "\t" + contacts[i].phoneNumbers[1].value;
									}
								}
								//								console.log(contact_arr_text);

								//将数据传给数据源
								contact_arr[i] = {
									value: i,
									text: contact_arr_text
								};
							}
							//							alert(contact_arr);

							//联系人数据提取关闭加载到选择器中
							userPicker.setData(contact_arr);
							userPicker.show(function(items) {
								//
								var texts = JSON.stringify(items[0]);
								var reg_name = /([\u4e00-\u9fa5]+)/g;
								var reg_number = /([0-9]+\s+[0-9]+\s+[0-9]+)|(1[0-9]+)/g;

								console.log(texts);
								//alert(texts);

								var person_name = texts.match(reg_name);
								var person_number = texts.match(reg_number);

								person_phone_name.value = person_name;
								person_phone_number.value = person_number;

								//返回 false 可以阻止选择框的关闭
								//return false;
							});
						}, false);
					}, function(e) {
						plus.ui.toast("未能获取到联系人数据!");
					})
				}, function(e) {
					plus.ui.toast("未能获取到手机通讯录!");
				})
			}, false);

			submit_info.addEventListener('tap', function() {

				var name = person_phone_name.value;
				var numbers = person_phone_number.value;

				if(!name) {
				mui.alert('请输入用户名!');
					return;
				}
				if(!numbers) {
					mui.aalert('请输入手机号');
					return;
				} else {
					var regularMobile = /^13[0-9]{9}$|14[0-9]{9}$|15[0-9]{9}$|18[0-9]{9}$|17[0-9]{9}$/;
					numbers = numbers.replace(/\s+/g, "");
					//alert(numbers);
					if(!numbers.match(regularMobile)) {
						mui.alert('手机号码格式有误');
						return;
					}
				}

				//alert(name);
				//alert(numbers);
				mui.ajax($$$.siturl + 'm=App&c=Tool&a=pullfriend', {
					type: 'post',
					data: {
						name: name,
						tele: numbers
					},
					dataType: 'json',
					success: function(data) {
						mui.alert(data.msg);
					},
					error: function(xhr, err) {
//						mui.alert(xhr);
					}
				});
			})
			fistajax()
				//所有数据
			function fistajax() {
				mui.ajax($$$.siturl + 'm=App&c=Tool&a=toall', {
					type: 'get',
					dataType: 'json',
					success: function(data) {
						//console.log(JSON.stringify(data));
						if(data.staus == 1) {
							bingtufr("#mytuijianruzhi", data.data);
						}
					},
					error: function(xhr, err) {
						//alert(err);
					}
				});
			}

			//自己推荐的
			function mystajax() {
				mui.ajax($$$.siturl + 'm=App&c=Tool&a=getTfriend', {
					type: 'get',
					dataType: 'json',

					success: function(data) {
						console.log(JSON.stringify(data));
						if(data.staus == 1) {
							bingtufr(".mytuijianruzhi", data.data);
						}
						if(data.staus == 0) {
							//									alert(3);
							//							var mytuijianruzhi = document.querySelector('.mytuijianruzhi');
							//							var wotuijian = document.querySelector('.wotuijian');
							//							mytuijianruzhi.style.display = "none";
							//							wotuijian.style.display = "none";

						}

					},
					error: function(xhr, err) {
						//alert(err);
					}
				});
			}
			var gengduo = document.querySelector('#gengduo');

			//			var a = '更多'

			var uyu = ""

			function bingtufr(id, data) {
				//				var uyu = ""
				//				alert(a)

				if(data.length > 3) {
					var uyu = 3;

				} else {
					uyu = data.length;
				}
				//				alert(uyu)
				//点击更多后
				gengduo.addEventListener('click', function() {
						if(gengduo.innerText == '更多') {
							gengduo.innerText = '收起'
							var str = ""
							if(data.length !== undefined) {
								for(var i = 0; i <3; i++) {
									//	 					alert(i)
									str += '<li style="border-bottom: 1px solid #B6B6B6;padding:5px;">'
									str += '<img src="images/huang' + i + '.png" style=" width: 40px;height:40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />'
									str += '<img src="' + $$$.imgurl + data[i].logo + '" style=" width: 40px;height:40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />'
									str += '<span style="display: inline-block;margin-left: 5%;width:20%">' + data[i].uname + '</span>'
									str += '<span style="display: inline-block;margin-left: 10%;"></span>'
									str += '<span style="display: inline-block;margin-left: 18%;">' + data[i].money + '</span>'
									str += '</li>'
								}
									for(var i = 4; i <7; i++) {
									//						alert(i)
									str += '<li style="border-bottom: 1px solid #B6B6B6;padding:5px;">'
									str += '<span style="display:inline-block; width: 40px;height:40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;line-height:40px;text-align:center;font-size:20px;">' + i + '</span>'
									str += '<img src="' + $$$.imgurl + data[i].logo + '" style=" width: 40px;height:40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />'
									str += '<span style="display: inline-block;margin-left: 5%;width:20%">' + data[i].uname + '</span>'
									str += '<span style="display: inline-block;margin-left: 10%;"></span>'
									str += '<span style="display: inline-block;margin-left: 18%;">' + data[i].money + '</span>'
									str += '</li>'
								}
								document.querySelector(id).innerHTML = str;
							}

						} else {
							gengduo.innerText = '更多'
							var str = ""
							if(data.length !== undefined) {
								for(var i = 0; i < 3; i++) {
									//						alert(i)
									str += '<li style="border-bottom: 1px solid #B6B6B6;padding:5px;">'
									str += '<img src="images/huang' + i + '.png" style=" width: 40px;height:40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />'
									str += '<img src="' + $$$.imgurl + data[i].logo + '" style=" width: 40px;height:40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />'
									str += '<span style="display: inline-block;margin-left: 5%;width:20%">' + data[i].uname + '</span>'
									str += '<span style="display: inline-block;margin-left: 10%;"></span>'
									str += '<span style="display: inline-block;margin-left: 18%;">' + data[i].money + '</span>'
									str += '</li>'
								}
								document.querySelector(id).innerHTML = str;
							}
						}
					})
				
					//原来版本
				var str = ""
				if(data.length !== undefined) {
					for(var i = 0; i < uyu; i++) {
						//						alert(i)
						str += '<li style="border-bottom: 1px solid #B6B6B6;padding:5px;">'
						str += '<img src="images/huang' + i + '.png" style=" width: 40px;height:40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />'
						str += '<img src="' + $$$.imgurl + data[i].logo + '" style=" width: 40px;height:40px; border-radius: 100%; vertical-align: middle; margin-left: 1%;" />'
						str += '<span style="display: inline-block;margin-left: 5%;width:20%">' + data[i].uname + '</span>'
						str += '<span style="display: inline-block;margin-left: 10%;"></span>'
						str += '<span style="display: inline-block;margin-left: 18%;">' + data[i].money + '</span>'
						str += '</li>'
					}
					document.querySelector(id).innerHTML = str;
				}

			}
			//点击更多
			//推荐成功
			var subcg=document.getElementById('subcg');
			localStorage.setItem("isTuiFried",'2');
			subcg.addEventListener('click', function() {
				mui.ajax($$$.siturl + 'm=App&c=Tool&a=islogin', {
					type: 'get',
					dataType: 'json',
					success: function(data) {
						
						//已经登陆
						if(data == "1") {
							
							mui.openWindow({
								url: "../tuijian/tuifchenggong.html",
								id: 'tuifchenggong'
							})
							
						}
						if(data == "0") {
							localStorage.setItem("isTuiFried",'1');
							mui.openWindow({
								url: '../login/login.html',
								id: 'login',
							})
							//     shoucang_icon.classList.remove('active');
						}
					},
					error: function(err) {
						//alert(err);
					}
				});
				
			})
				
		</script>
	</body>

</html>