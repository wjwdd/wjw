
		var text2 = document.querySelector('.text2');
		var box = document.querySelector('.box');
		box.onclick = function() {
			box.style.display = "none"
		}

		mui.ajax($$$.siturl + 'm=App&c=Tool&a=islogin', {
			type: 'get',
			dataType: 'json',
			success: function(data) {
				//已经登陆
				var isjid = localStorage.getItem('jid');
				if(data == 1) {
					mui.ajax($$$.siturl + 'm=App&c=ApplyJob&a=checkfavor', {
						type: 'post',
						data: {
							jid: isjid
						},
						success: function(isShouCang) {
							if(isShouCang == 1) {
								var result = "";
								result += '<img src="images/175.png" width="31.2px"><br><span style=" color: #666666;">已收藏</span>';
								var showcang = document.querySelector('#showcang');
								showcang.innerHTML = result;
							}
						}

					});
				}
			},
			error: function(err) {
				//alert(err);
			}
		});
	
		var di=false;
		var qygk=false;
		var fenxiangurl,fengxianglog,fengxiangtext,fengxiangtop;
		// 点击实现页面的跳转以及给按钮加背景色
		var button_apply = document.querySelector('#button_apply');
		button_apply.addEventListener('touchstart', function() {
			// alert(this.innerHTML);
			// alert('done');
			this.classList.add('active');
		});
		button_apply.addEventListener('touchend', function() {
			this.classList.remove('active');
			var jid = localStorage.getItem('jid');

			//alert($$$.siturl+'m=App&c=ApplyJob&a=resume_apply');

			console.log();
			mui.ajax($$$.siturl + 'm=App&c=ApplyJob&a=resume_apply', {
				type: 'post',
				data: {
					jid: jid,
				},
				dataType: 'json',
				success: function(data) {
					
					if(data.staus == 9) {
						mui.openWindow({
							url: '../login/bianji_delete.html',
							id: 'bianji_delete',
						})

						return;
					}

					if(data.staus == 1) {
						button_apply.onclick = function() {
								box.style.display = "block"
								text2.innerHTML = data.msg
							}

//						mui.alert(data.msg);
						//mui.toast(data.msg,{ duration:'long', type:'div' })
					}

					if(data.staus == 0) {
						//mui.toast(data.msg,{ duration:'long', type:'div' }) 
						mui.openWindow({
							url: '../login/login.html',
							id: 'bianji_delete',
						})

					}
				},
				error: function(err) {
					mui.alert(err);
				}
			})

		})
		button_apply.addEventListener('touchmove', function() {
			this.classList.remove('active');
		})

		// 点击收藏实现图标变色并且申请职位
		var shoucang_icon = document.querySelector('#showcang');
		shoucang_icon.addEventListener('touchstart', function() {
			shoucang();
		});

		function shoucang() {

			var jid = localStorage.getItem('jid');

			mui.ajax($$$.siturl + 'm=App&c=ApplyJob&a=resume_showcang', {
				type: 'post',
				data: {
					jid: jid
				},
				dataType: 'json',
				success: function(data) {
					if(data.staus == 9) {
						mui.openWindow({
							url: '../login/bianji_delete.html',
							id: 'bianji_delete'
						});
						return;
					}

					if(data.staus == 1) {
						mui.ajax($$$.siturl + 'm=App&c=ApplyJob&a=checkfavor', {
							type: 'post',
							data: {
								jid: jid
							},
							success: function(isShouCang) {
								if(isShouCang == 1) {
									var result = "";
									result += '<img src="images/175.png" width="31.2px"><br><span style=" color: #666666;">已收藏</span>';
									var showcang = document.querySelector('#showcang');
									showcang.innerHTML = result;
								} else {
									var result = "";
									result += '<img src="images/131.png" width="31.2px"><br><span style=" color: #666666;">收藏职位</span>';
									var showcang = document.querySelector('#showcang');
									showcang.innerHTML = result;
								}
							}

						});
						mui.toast(data.msg, {
							duration: 'long',
							type: 'div'
						})
					}
					//没有登录
					if(data.staus == 0) {
						mui.toast(data.msg, {
							duration: 'long',
							type: 'div'
						})
						mui.openWindow({
								url: '../login/login.html',
								id: 'bianji_delete',
							})
							//     shoucang_icon.classList.remove('active');
					}
				},
				error: function(err) {
					mui.alert(err);
				}
			})
		}

		
			// 轮播图
			var jid = localStorage.getItem('jid');

			mui.ajax($$$.siturl + 'm=App&c=index&a=compangprofil&jid=' + jid, {
				type: 'get',
				success: function(data) {
					
					var jsons = JSON.parse(data);
					fengxiangtop="直招帮";
					fengxianglog=$$$.imgurl+'data/weixin/1.png';
					fengxiangtext="【直招帮】 " + jsons.data.jobs_name + "正在招"+jsons.data.category_cn
									+"综合工资"
									+jsons.data.minwage
									+"--"
									+jsons.data.maxwage
									+" 就等你来报名";
					//console.log(fengxiangtext);
					fengxiangtop=fengxiangtext;
					var sliderbox = document.querySelector('#slider');
					var blunbo = document.querySelector('.blunbo');
					var jobs = jsons.job;

					var reslut = "";
					//console.log(jobs);
					for(var i = 0; i < jobs.length; i++) {

						var tags = jobs[i].tag_cn.split(',');
						var leng = 0;
						if(tags.length > 3) {
							leng = 3;

						} else {
							leng = tags.length;
						}
						var srce = '';
						for(var x = 0; x < leng; x++) {
							// alert(tags[i]);
							srce += '<span style="font-size:12px;line-height: 12px;height:18px;padding:2px 4px;margin-right:2px;box-sizing: border-box;display: inline-block;text-align: center;border:1px solid #5CA8FC;border-radius: 5px;color:#5CA8FC;margin-right:3px;">';
							srce += tags[x] + '</span>';
						}

						reslut += '<li class="mui-table-view-cell mui-media li_togo_next" id="' + jobs[i].jid + '">';
						reslut += '<a href=":;">';
						reslut += ' <div class="mui-media-body" style="">';
						// 公司名称 + 薪资
						reslut += '<span class="mui-ellipsis" style="color: #8f8f94;color:#000;font-size:15px;font-weight:700;">' + jobs[i].jobs_name + ' </span><span class="mui-ellipsis mui-pull-right" style="color: #EB793B;">' + jobs[i].minwage + '-' + jobs[i].maxwage + '元</span>';

						// 第二行工种  + 小标签 + 地区
						reslut += '<p class=""><span class="mui-ellipsis; " style="color: #737373;">' + jobs[i].category_cn + '</span><span style=" position: absolute;left: 25%;" class="mui-ellipsis">' + srce + '</span><span style="color: #000;font-size:13px;" class="mui-ellipsis mui-pull-right" >' + jobs[i].district_cn + '</span></p>';

						reslut += '</div>';
						reslut += '</a>';
						reslut += '</li>';
					}
					var str2='';

					str2+='<div class="bt" style="margin:0 0 50px;background:#efeff4;padding: 20px 0 20px;text-align: center;">您想要的职位没有找到？';
					str2+='<a href="../search/search.html">立即搜索</a>';
					str2+='</div>';
					document.querySelector('.uilist').innerHTML = reslut+str2;
					
					//console.log(JSON.stringify(jsons.data));
					//点击事件
					//console.log(JSON.stringify(jsons.data.contantshow));
//					if(jsons.data.contantshow == 1) {
//						console.log(JSON.stringify(jsons.data.contanttel));
//						var contantshow = document.querySelector('.contantshow')
//						contantshow.setAttribute('href', "tel:" + jsons.data.contanttel);
//					} else {
//						var contantshow = document.querySelector('.contantshow')
////						contantshow.setAttribute('href', "tel:" + jsons.data.S4mobile);
//
//					}
					//					if(jsons.contantshow==undefined){
					//						var contantshow =document.querySelector('.contantshow')
					//						contantshow.setAttribute('href',"tel:"+jsons.data.S4mobile);
					//					}

					var alist = document.querySelectorAll('.li_togo_next');

					for(var i = 0; i < alist.length; i++) {

						alist[i].addEventListener('click', function(e) {
							e.preventDefault();
							localStorage.setItem("jid", this.getAttribute('id'));
							mui.openWindow({
								url: 'job.html',
								id: localStorage.getItem("jid")
							});
							e.stopPropagation();
						})
					}

					var tags = jsons.data.fuli.split(',');
					var leng = 0;
					if(tags.length > 4) {
						leng = 4;

					} else {
						leng = tags.length;
					}
					var srce = '';
					var imgarr;
					imgarr = ['gender', 'age', 'degree'];
					for(var i = 0; i < leng; i++) {
						srce += '<span style="background: url(images/' + imgarr[i] + '.png) no-repeat;background-size: 16px 16px;font-size:12px;line-height: 12px;height:18px;padding:2px 0;padding-left:18px;display: inline-block;color:#737373;;margin-right:11px;margin-left:5px;">' + tags[i] + '</span>';

					}

					localStorage.setItem('xmap', jsons.data.map_x);
					localStorage.setItem('ymap', jsons.data.map_y);

					function htmlDecode(text) {
						//1.首先动态创建一个容器标签元素，如DIV
						var temp = document.createElement("div");
						//2.然后将要转换的字符串设置为这个元素的innerHTML(ie，火狐，google都支持) 
						temp.innerHTML = text;
						//3.最后返回这个元素的innerText(ie支持)或者textContent(火狐，google支持)，即得到经过HTML解码的字符串了。
						var output = temp.innerText || temp.textContent;
						temp = null;
						return output;
					}
					tel(jsons.data);
					lunbotu(jsons.img);
					document.querySelector('.libaiduditu').innerHTML = jsons.data.address;
					document.querySelector('#title_company').innerHTML = jsons.data.jobs_name;
					document.querySelector('.tagxiaobiaoqian').innerHTML = srce;
					document.querySelector('.caozuogong').innerHTML = jsons.data.category_cn;
					document.querySelector('.spanmony').innerHTML = jsons.data.minwage + '-' + jsons.data.maxwage + '元';
					document.querySelector('.gongsimingchneg-li').innerHTML = jsons.data.companyname;
					document.querySelector('.qiyexinxi-li').innerHTML = jsons.data.nature_cn + ' | ' + jsons.data.district_cn;
					var dddd = htmlDecode(jsons.data.contents);
					var div2 = document.createElement('div');
					div2.innerHTML = dddd;
					
					var obj = Resoveto(jsons.data.contents)
					var s = creatXiangqing(obj);

					localStorage.setItem('addresstocompor', jsons.data.address)
					var box = document.querySelector('.zhiwexiangqingxinxi');
					
					var str1='';
					str1+='<div class="baozhang" style=" width: 100%;margin-top: 10px; color: #666666; font-size:13px; background-color: #FFFFFF; text-align: center;">';
					str1+='<img style="width:100%;" src="'+$$$.imgurl+'data/app/xinyu.png" alt="" />	';
					str1+='</div>';
					str1+='<li class="mui-table-view-cell" style="margin-top:8px;font-weight: 700;padding-left:45px;background: url(images/tuijianzhiwei.png) no-repeat 10px center;background-size: 20px 25px; background-color: #FFFFFF;">推荐职位</li>';
					box.innerHTML = s+str1;
					document.querySelector('.gongsimingchneg-li').setAttribute('data-id', jsons.data.cid);
					document.querySelector('.gongsimingchneg-li').setAttribute('data-jid', jsons.data.jid);

					document.querySelector('.gsxq').addEventListener('click', function(e) {
						e.preventDefault();
						var cid = this.children[2].getAttribute('data-id');
						localStorage.setItem("cid", cid);
						mui.openWindow({
							url: '../company/company.html',
							id: 'company',
						})
						e.stopPropagation();
					});

					//轮播图
					var result = '';

					function lunbotu(jsons) {

						var result = '';
						var tar = jsons;
						//(JSON.stringify(tar));
						var url = $$$.imgurl;
						// alert(url);
						result += '<div ><img style="width:100%;height:140px;" src="' + url + tar[tar.length - 1] + '" /></div>';
//						result += '<div class="mui-slider-item"><a href="#"><img style="height:140px;" src="' + url + tar[0] + '" /></a></div>';
//						for(var x = 1; x < tar.length - 1; x++) {
//							result += '<div class="mui-slider-item"><a href="#"><img style="height:140px;" src="' + url + tar[x] + '" /></a></div>';
//						}
//						result += '<div class="mui-slider-item"><a href="#"><img style="height:140px;" src="' + url + tar[tar.length - 1] + '" /></a></div>';
//						result += '<div class="mui-slider-item"><a href="#"><img style="height:140px;" src="' + url + tar[0] + '" /></a></div>';
						blunbo.innerHTML = result;

						// 创建轮播图对象
						var gallery = mui('.mui-slider');
						gallery.slider({
							interval: 0 //自动轮播周期，若为0则不自动播放，默认为0；
						});
					}
					//字符串解析
					function Resoveto(data) {
						//console.log(data);
						var arry = [];
						var ay = new Array();
						var to = new Array();
						ay = data.split('【')
						for(var i = 0; i < ay.length; i++) {
							to = ay[i].split('】');

							var st = String(to[1]);
							///\d、/
							var stin = st.replace(/\d、/g, '|');

							var xiangqing = stin.split('|');
							if(xiangqing.length > 1) {
								var au = [];
								for(var x = 0; x < xiangqing.length; x++) {
									au.push(xiangqing[x]);
								}
								//console.log(au);
								var ob = {
									title: to[0],
									text: au,
									isbul: 1
								};
							} else {
								var ob = {
									title: to[0],
									text: to[1],
									isbul: 2
								};
							}

							arry.push(ob);
						}

						arry.shift(0)
						if(arry.length) {
							return {
								key: 1,
								value: arry
							};
						} else {
							return {
								key: 2,
								value: data
							};
						}
					}
					//插入解析字符串
					function creatXiangqing(data) {
						//console.log(JSON.stringify(data));
						var str = "";
						if(data.key == 1) {
							data1 = data.value;
							for(var i = 0; i < data1.length; i++) {
								str += '<div id=""style="height:40px;line-height:40px;font-size:17px;background-color:#fff;padding:0 10px;margin-top:10px;color:#5CA8FC;border-bottom:1px solid #efefef;"><span style="font-weight:1000;width:100%;">| </span>' + data1[i].title + ':</div>';
								str += '<div style="padding:0 10px ;text-indent: 1em;font-size:14px;color:#888;padding-bottom:10px;padding-top:5px;background-color:#fff;" >';
								if(data1[i].isbul == 1) {
									var sss = data1[i].text;
									for(var t = 1; t < sss.length; t++) {
										if(sss[t] != '') {
											if(t != 1) {
												str += '<span style="padding-left:10px;">' + t + '</span>' + '、' + sss[t] + '<br/>';
											} else {
												str += '<span style="margin-left:-5px;">' + t + '</span>' + '、' + sss[t] + '<br/>';
											}

										}
									}
								} else {
									str += data1[i].text;
								}

								str += '</div>';
							}

						} else if(data.key == 2) {
							str = data.value;
						}

						return str;
					}

					function tel(data){
							console.log(JSON.stringify(data));
							mui.ajax($$$.siturl + 'm=App&c=Tool&a=islogin', {
								type: 'get',
								dataType: 'json',
								success: function(data1) {
									
									if(data1=="1"){
										
										if(data.contantshow=="0"){
											
										var teclip=document.querySelector(".clicktop");
										var xianshichu=document.querySelector(".xianshichu");
										
											teclip.setAttribute("href","tel:"+data.S4mobile);
											xianshichu.setAttribute("onclick",null)
											//console.log(teclip.getAttribute("href"));
										} 
										if(data.contantshow=="1"){
											
											document.querySelector(".telss00").setAttribute("href","tel:"+data.S4mobile);
											document.querySelector(".gongchnagid").setAttribute("href","tel:"+data.contanttel);
										}
										
										
									} 
									
									if(data1=="0"){
										di=true;
									}									
							}})
					} 
					
					function islogin2(){
	
					}
						
				},
				error: function(err) {
					mui.alert(err);
				}
			});
		
		
		function goJobLink() {
			//var jid = localStorage.getItem('jid');
			//localStorage.setItem('jid',jid);
			mui.openWindow({
				url: '../job/job.html',
				id: 'job',
				extras: {
					jid: jid
				},
				createNew: false, //是否重复创建同样id的webview，默认为false:不重复创建，直接显示
				waiting: {
					autoShow: true, //自动显示等待框，默认为true
					title: '正在加载...', //等待对话框上显示的提示内容
				}
			})
		}
		function xianshichu(){
			
				console.log(qygk);
				if(di){
					mui.openWindow({
						url: '../login/login.html',
						id: 'login',
					})
					di=false;
				}else{
					
						document.querySelector("#xianshi").style.display='block';
							document.querySelector("#zt").style.display='block';
							document.querySelector("#zt").onclick=function(){
								document.querySelector("#xianshi").style.display='none';
								document.querySelector("#zt").style.display='none';
								
							
					}
					
				}		
		}
		function Tomap() {

					mui.openWindow({
						url: 'map.html',
						id: 'map.html',
						extras: {

						},
						createNew: false, //是否重复创建同样id的webview，默认为false:不重复创建，直接显示
						waiting: {
							autoShow: true, //自动显示等待框，默认为true
							title: '正在加载...', //等待对话框上显示的提示内容
						}
					})
				}
//		var dis = true;
		document.addEventListener('plusready', function() {

			var dian = document.querySelector('.tel');
			var yangshi = document.querySelector('#yangshi');
			var clicktop = document.querySelector('.clicktop');
			var xianshichu = document.querySelector('.xianshichu');
				var xianshichu1 = document.querySelector('.xianshichu1');
			var jid = localStorage.getItem('jid');
			
			
			
//							mui.ajax($$$.siturl + 'm=App&c=index&a=compangprofil&jid='+jid,{
//									dataType:'json',
//									type:'get',	              
//									success:function(data){
//										if(data.data.contantshow =="1"){
//											
//										}
//										if(data.data.contantshow =="0"){
//											clicktop.setAttribute("href","tel:4008334588");
//											//console.log(clicktop.outerHTML);
//										}
//									},
//									error:function(xhr,type,errorThrown){
//										//异常处理；
//										console.log(type);
//									}
//								});
				
//			dian.onclick=function(){
////				xianshichu1.style.display='none';
////				xianshichu.style.display='block';
//				mui.ajax($$$.siturl + 'm=App&c=Tool&a=islogin', {
//					type: 'get',
//					dataType: 'json',
//					success: function(data) {
//						if(data == "1") {
							
							
								
						
//							document.onclick=function(ev){
//								var event=ev||window.event;
//								var target =event.target||event.srcElement;
//								alert(target.className);
//								if(target.className!='clicktop'){
//									document.querySelector("#xianshi").style.display='none';
//								}else{
//									document.querySelector("#xianshi").style.display='block';
//								}
//							}
//
//						}
			
//						if(data == 0) {
//							
//						
//						}
//					},
//					error: function(err) {
//						alert(err);
//					}
//				});
//			}
//				
//			
			plus.webview.close('map.html');
		})
		
//	document.addEventListener("plusready", function() {		
//			
//			plus.webview.close('map.html');}, true);
	document.addEventListener("plusready", onPlusReady, false);
	var yusr=document.querySelector("#share");
	
		function onPlusReady() {
					yusr.addEventListener("click", shareHref, false);
					updateSerivces(); 

//		            document.getElementById('weixin').addEventListener('tap',function() {
//			            console.log("微信"); 
//			            authLogin('weixin'); 
//			        }) 
			        
		            if (plus.os.name == "Android") {
		                Intent = plus.android.importClass("android.content.Intent"); 
		                File = plus.android.importClass("java.io.File"); 
		                Uri = plus.android.importClass("android.net.Uri"); 
		                main = plus.android.runtimeMainActivity(); 
		            } 
						 
						/**分享按钮*/
					   function shareHref() { 
					   		console.log(this);
				            var ids = [{ 
				                    id: "weixin",  
				                    ex: "WXSceneSession"  /*微信好友*/ 
				                }, { 
				                    id: "weixin", 
				                    ex: "WXSceneTimeline" /*微信朋友圈*/ 
				                }], 
				                bts = [{ 
				                    title: "发送给微信好友" 
				                }, { 
				                    title: "分享到微信朋友圈" 
				                }]; 
				            plus.nativeUI.actionSheet({ 
				                    cancel: "取消", 
				                    buttons: bts 
				                }, 
				                function(e) { 
				                	
				                    var i = e.index; 
				                    if (i > 0) { 
				                        shareAction(ids[i - 1].id, ids[i - 1].ex); 
				                    } 
				                } 
				            ); 
				        } 
			        
				         /** 
				         * 分享操作 
				         */ 
				        function shareAction(id, ex) { 
				            var s = null; 
				            console.log(id,ex);
				            if (!id || !(s = shares[id])) { 
				                outLine("无效的分享服务！"); 
				                return; 
				            } 
				            console.log(s.authenticated);
				            if (s.authenticated) { 
				                outSet("---已授权---"); 
				                shareMessage(s, ex); 
				            } else { 
				                outSet("---未授权---"); 
				                s.authorize(function() { 
				                    shareMessage(s, ex); 
				                }, function(e) { 
				                    outLine("认证授权失败"); 
				                }); 
				            } 
				        }
				        
						/** 
				         * 发送分享消息 
				         */ 
				  function shareMessage(s, ex) { 
				        	
				        var jidjob= localStorage.getItem('jid');
				        	console.log(ex);
				        	console.log(JSON.stringify(s));
				            var msg = { 
				               
				                href: 'http://www.zhizhaojob.cn/index.php?m=Mobile&c=jobs&a=show&id='+jidjob, 
				                title: fengxiangtop, 
				                content: fengxiangtext, 
				                thumbs: [fengxianglog], 
				                pictures: [fengxianglog], 
				                extra: { 
				                    scene: ex 
				                } 
				            }; 
				            s.send(msg, function() { 
				                outLine("分享成功!"); 
				            }, function(e) { 
				                outLine("分享失败!"); 
				            }); 
				        } 
				        
		                /** 
				         * 更新分享服务 
				         */ 
				        function updateSerivces() { 
				            plus.share.getServices(function(s) { 
				                shares = {}; 
				                for (var i in s) { 
				                    var t = s[i]; 
				                    shares[t.id] = t; 
				                } 
				                outSet("获取分享服务列表成功"); 
				            }, function(e) { 
				                outSet("获取分享服务列表失败：" + e.message); 
				            }); 
				        } 

						// 控制台输出日志 
				        function outSet(msg) { 
//				            console.log(msg); 
				        } 
				        // 界面弹出吐司提示 
				        function outLine(msg) { 
				            mui.toast(msg); 
				        } 
				        
				         // 登录操作 
				        function authLogin(type) { 
				            var s; 
				            for (var i = 0; i < auths.length; i++) { 
				                if (auths[i].id == type) { 
				                    s = auths[i]; 
				                    break; 
				                } 
				            } 
				            if (!s.authResult) { 
				                s.login(function(e) { 
				                    mui.toast("登录认证成功！"); 
				                    authUserInfo(type); 
				                }, function(e) { 
				                    mui.toast("登录认证失败！"); 
				                }); 
				            } else { 
				                mui.toast("已经登录认证！"); 
				            } 
				        }
				        
				        
				    // 微信登录认证信息 
			        function authUserInfo(type) { 
			            var s; 
			            for (var i = 0; i < auths.length; i++) { 
			                if (auths[i].id == type) { 
			                    s = auths[i]; 
			                    break; 
			                } 
			            } 
			            if (!s.authResult) { 
			                mui.toast("未授权登录！"); 
			            } else { 
			                s.getUserInfo(function(e) { 
			                    var josnStr = JSON.stringify(s.userInfo); 
			                    var jsonObj = s.userInfo; 
			                    console.log("获取用户信息成功：" + josnStr); 
			                    showData(type,jsonObj); 
			                    authLogout(); 
			                }, function(e) { 
			                    alert("获取用户信息失败：" + e.message + " - " + e.code); 
			                }); 
			            } 
			        } 
			        
			        function showData(type,data) { 
			            switch (type){ 
			                case 'weixin': 
			                    headImage.src = data.headimgurl; 
			                    break; 
			                case 'qq': 
			                    headImage.src = data.figureurl_qq_2; 
			                    break; 
			                case 'sinaweibo': 
			                    headImage.src = data.avatar_large; 
			                    break; 
			                default: 
			                    break; 
			            } 
			        } 
								        
				        
				}	
	
	
