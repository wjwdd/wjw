<!DOCTYPE html>
<html ng-app="commitCtr">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />

		<link href="../../css/mui.min.css" rel="stylesheet" />
		<title></title>
	</head>
	<style>
		.ifr {
			width: 100%;
		}
		
		.mui-bar-nav {
			-webkit-box-shadow: none;
			box-shadow: none;
		}
	</style>

	<body ng-controller="myCtrl" style="background:#fff;">
		<header id="header" class="mui-bar mui-bar-nav header-top mui-bar-transparent" data-top='0' data-offset='150' data-duration='16' data-scrollby=".mui-scroll-wrapper">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left wagecolor"></a>
			<h1 class="mui-title" ng-bind="data.title" style="color:#fff">消息列表</h1>
		</header>

		<div class="mui-scroll-wrapper" style="margin-top:-22px;">
			<div class="mui-scroll">
				<div style="">
					<div><img style="width:100%" ng-src={{imgurl+data.small_img}} alt="" /></div>
					<p class="counttolig" style='padding:10px;'>

					</p>

				</div>
			</div>
		</div>

		<!--<iframe class="ifr" scrolling="no" onload="changeFrameHeight()" frameborder="0"> </iframe> -->

	</body>
	<script src="../../js/mui.min.js"></script>
	<script src="../../js/ag1.46.js" type="text/javascript" charset="utf-8"></script>
	<script src="../../js/factory.js" type="text/javascript" charset="utf-8"></script>
	<script>
		//		var ifr=document.querySelector(".ifr");
		//		var aid= localStorage.getItem('aid');
		//		ifr.src="http://192.168.1.107/?m=Mobile&c=news&a=newsdetal&id="+aid;

		angular.module('commitCtr', ['myApp'])
			.controller('myCtrl', function($scope, $http, $data) {
				mui.plusReady(function() {
					var scroll = mui('.mui-scroll-wrapper').scroll();
					document.querySelector('.mui-scroll-wrapper').addEventListener('scroll', function(e) {

						if(scroll.y < -80) {
							document.querySelector('.mui-title').style.color = '#000';
						} else if(scroll.y > -80) {
							document.querySelector('.mui-title').style.color = '#fff';
						}
					})
					var self = plus.webview.currentWebview();
					var id = self.pid;
					$data.xiaoxidetail(id).success(function(response) {
//						console.log(JSON.stringify(response));
						$scope.data = response.data;
						$scope.imgurl = $$$.imgurl;
						//$scope.content=response.data.content;
					})
					mui.ajax($$$.siturl + 'm=App&c=XiTongMsg&a=newsDetalcount&id=' + id, {
						success: function(data) {
							var temp = document.createElement("div")
							temp.innerHTML = data;
							var counttolig = document.querySelector(".counttolig");
							var output = temp.innerText || temp.textContent;
							counttolig.innerHTML = output;
						},
						error: function(xhr, err) {

						}
					});

				})

			})

		//		获取页面尺寸
		//		function changeFrameHeight(){
		//  		
		//		    ifr.height=document.documentElement.clientHeight;
		//		}
		//		window.onresize=function(){  
		//			     changeFrameHeight();  
		//		}
	</script>

</html>