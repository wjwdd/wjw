<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		
		<link href="../../../css/mui.min.css" rel="stylesheet" />
		<link href="../../../css/jiazaidonghua.css" rel="stylesheet" />

		<style>
			li {
				list-style: none;
			}
			
			.staricon {
				font-size: 15px;
				height: 15px;
				line-height: 15px;
				color: #DF6659;
			}
			/*.bg2 {
				font-size: 13px;
				display: inline-block!important;
				padding: 3px 15px;
				border: 1px solid #8D8D8D;
				border-radius: 5px;
				margin-bottom: 15px;
				margin-right: 20px;
				color: #000;
			}*/
		</style>
		<script type="text/javascript">
		</script>
	</head>

	<body>
		<div class="jiazai">
			<div class="spinner">
				<div class="spinner-container container1">
					<div class="circle1"></div>
					<div class="circle2"></div>
					<div class="circle3"></div>
					<div class="circle4"></div>
				</div>
				<div class="spinner-container container2">
					<div class="circle1"></div>
					<div class="circle2"></div>
					<div class="circle3"></div>
					<div class="circle4"></div>
				</div>
				<div class="spinner-container container3">
					<div class="circle1"></div>
					<div class="circle2"></div>
					<div class="circle3"></div>
					<div class="circle4"></div>
				</div>
			</div>
		</div>
		<header id="header" class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left" style="color:#26aa12;"></a>
			<h1 class="mui-title">名企推荐</h1>
		</header>
		<div class="cjs"></div>
		<div class="mui-scroll-wrapper ">
			<div class="mui-scroll allheight">
				<div class="mui-slider" style="padding-top:44px;">
					<div class="mui-slider-group mui-slider-loop" id="slider">

					</div>
				</div>

				<ul class="mui-table-view uilist first_content" id="refreshContainer" style="margin-top: 0px;">
					<!--作者：1311875357@qq.com
	时间：2017-04-07 
	描述：-->
					<!--<li class="mui-table-view-cell mui-media" style="padding: 11px 0 11px 0px;">
				<a href="javascript:;" style="width: 100%;height: 90px;">
					<img class="mui-media-object mui-pull-left" src="../../../images/man.png" style="position:relative;float:left;height: 60px;width:20%;border-radius: 3px;margin-top: .4em;max-width: none;">

					<div class="mui-media-body" style="position: relative;float:left;margin-top: 4px; width: 70%;">
						<p class='mui-ellipsis' style="padding-left: 20px; font-size: 17px; color: black;">青岛龙鹤制衣有限公司</p>
						<div class="" style=" height: 15px;margin-left: 20px; font-size: 17px; line-height: 15px; margin-bottom: 5px;">
							<span class="mui-icon mui-icon-star-filled staricon"></span>
							<span class="mui-icon mui-icon-star-filled staricon"></span>
							<span class="mui-icon mui-icon-star-filled staricon"></span>
							<span class="mui-icon mui-icon-star-filled staricon"></span>
							<span class="mui-icon mui-icon-star-filled staricon"></span>
						</div>
						<p class=""></p><span style="color: #8f8f94;padding-left: 20px;font-size: 17px;color: black; display: inline-block; height: 17px;line-height: 17px;" class="mui-ellipsis">其他行业</span>
						<span style="color: #8f8f94;font-size: 12px;color: black; display: inline-block; float: right; height: 17px;line-height: 17px;" class="mui-ellipsis">其他行业</span>
					</div>
				</a>
				<div class="bg" style="background-color: #EBEBEB; padding-top: 15px; padding-left: 15px;">
					<span style="font-size: 13px; display: inline-block; padding:3px 15px; border:1px solid #8D8D8D;border-radius: 5px; margin-bottom: 15px; margin-right: 20px; color: #000;">技术员</span>
					<span style="font-size: 13px; display: inline-block; padding:3px 15px; border:1px solid #8D8D8D;border-radius: 5px; margin-bottom: 15px; margin-right: 20px; color: #000;">技术员</span>
				</div>
			</li>-->
				</ul>
			</div>
		</div>
	</body>
	<!--<script src="js/mingqi.js"></script>-->
	<script src="../../../js/mui.min.js"></script>
	<script src="../../../js/jiazaidonghua.js"></script>
	<script>
		mui.ajax($$$.siturl + 'm=App&c=Tool&a=mingqilunbo5', {
			type: 'get',
			data: {

			},
			dataType: 'json',
			success: function(data) {
				var sliderbox = document.querySelector('#slider');

				lunbotu(data.data);
				//alert(JSON.stringify(data));
			}
		})

		function Creat_MQ(option) {
			this.id = option.id;
			this.data = option.data;

			this.init();
		}
		Creat_MQ.prototype = {
			init: function() {
				var lidata = this.creater(this.datafun());

				this.insert(lidata);
			},
			datafun: function() {
				return this.data;
			},
			creater: function(datas) {
				var result = "";
				(function(datas) {
					for(var i = 0; i < datas.length; i++) {
						var data = datas[i];
						result += '<li class="mui-table-view-cell mui-media" style="padding: 11px 0 11px 15px;" data-id=' + data.id + ' onclick="gotolind(this)">';
						result += '<a href="javascript:;" style="width: 100%;height: 90px;">';
						result += '<img class="mui-media-object mui-pull-left" src="' + $$$.imgurl + data.logo + '" style="position:relative;float:left;height: 60px;width:20%;border-radius: 3px;margin-top: .4em;max-width: none;">';
						result += '<div class="mui-media-body" style="position: relative;float:left;margin-top: 4px; width: 70%;">';
						result += '<p class="mui-ellipsis" style="padding-left: 0px; font-size: 13px; color: black;">' + data.companyname + '</p>';
						result += '<div class="" style=" height: 15px;margin-left: 0px; font-size: 17px; line-height: 15px; margin-bottom: 5px;">';
						result += '<span class="mui-icon mui-icon-star-filled staricon"></span>';
						result += '<span class="mui-icon mui-icon-star-filled staricon"></span>';
						result += '<span class="mui-icon mui-icon-star-filled staricon"></span>';
						result += '<span class="mui-icon mui-icon-star-filled staricon"></span>';
						result += '<span class="mui-icon mui-icon-star-filled staricon"></span>';
						result += '</div>';
						result += '<p class=""></p><span style="padding-left: 0px;font-size: 13px;color: black;" class="mui-ellipsis">' + data.district_cn + '</span>';
						result += '<span class="show" style="color:#26aa12;font-size: 13px;color: black; display: inline-block; float: right; height: 17px;line-height: 17px;" class="mui-ellipsis" onclick="show(this)">' + "在招" + '' + data.count + '' + "个职位" + '<img src="../../../images/jiantou.png" style="width: 18px; padding-left: 2px;"></span>';
						result += '</div>';
						result += '</a>';
						result += '<div class="bg" style="background-color:#ECEAEA; padding-top: 15px; padding-left: 15px; display:none;">';
						for(var x = 0; x < data.tagUrl.length; x++) {
							result += '<span class="bg2" style="font-size: 13px; display: inline-block; padding:3px 15px; border:1px solid #8D8D8D;border-radius: 5px; margin-bottom: 15px; margin-right: 25px; color: #000;" data-jobid="' + data.tagUrl[x].id + '" onclick="openjob(this)">' + data.tagUrl[x].tag + '</span>'
						}
						result += '</div>';
						result += '</li>';
					}
				})(datas)
				return result;
			},
			insert: function(data) {
				var self = this;
				var div = document.createElement('div');
				var list = document.querySelector(this.id);
				//				console.log(list);

				div.innerHTML = data;

				if(list.append) {
					list.append(div);
				} else {
					list.appendChild(div);
				}
				var lilist = div.children;
				/*  	for(var i=0;i<lilist.length;i++){
							//alert(lilist[i]);
						lilist[i].onclick=function(){
			            	var li=this;
			            	var cid=li.getAttribute('data-id');
							localStorage.setItem("cid", cid);
							mui.openWindow({
							    url:'../../company/company.html',
							    id:'company',
							})
		           		}
					}
				*/
			},
		};
		//阻止冒泡
		function stopPropagation() {
			var event = window.event || event;　
			if(event.stopPropagation) {　　
				event.stopPropagation();　　
			} else {　　　　
				event.cancelBubble = true;　　
			}
		}

		function show(data, e) {

			stopPropagation(e);
			//			console.log(data)
			var bg = data.parentNode.parentNode.parentNode.childNodes[1];
			if(bg.style.display == "none") {
				bg.style.display = "block";
			} else {
				bg.style.display = "none";
			}
		}

		function openjob(data, e) {
			stopPropagation(e);
			var datajobid = data.getAttribute("data-jobid");
			localStorage.setItem("jid", datajobid);
			mui.openWindow({
				url: '../../job/job.html',
				id: 'job',
				extras: {
					// jid:jid
				},
				createNew: false, //是否重复创建同样id的webview，默认为false:不重复创建，直接显示
				waiting: {
					autoShow: true, //自动显示等待框，默认为true
					title: '正在加载...', //等待对话框上显示的提示内容
				}
			})
		}

		var page = 1;

		mui.ajax($$$.siturl + 'm=App&c=index&a=minqitj&page=' + page, {
			type: 'get',
			data: {},
			dataType: 'json',
			success: function(str) {
				crea('.uilist', str.data);

				function crea(id, data) {
					var list = new Creat_MQ({
						id: id,
						data: data,
					})
				}
			},
			error: function(xhr, type, errorThrown) {
				mui.toast('遇到问题，正在完善', {
					duration: 'short',
					type: 'div'
				});
			}
		})

		//		mui.init({
		//		  pullRefresh : {
		//			    container:'#refreshContainer',//待刷新区域标识，querySelector能定位的css选择器均可，比如：id、.class等
		//			    up : {
		//		      height:50,//可选.默认50.触发上拉加载拖动距离
		//		      auto:true,//可选,默认false.自动上拉加载一次
		//		      contentrefresh : "正在加载...",//可选，正在加载状态时，上拉加载控件上显示的标题内容
		//		      contentnomore:'没有更多数据了',//可选，请求完毕若没有更多数据时显示的提醒内容；
		//		      callback :pullfresh_function //必选，刷新函数，根据具体业务来编写，比如通过ajax从服务器获取新数据；
		//		    }
		//		  } 
		//		});

		function pullfresh_function() {
			page++;
			request();
			this.endPullupToRefresh(false);

			function request() {
				mui.ajax($$$.siturl + 'm=App&c=index&a=minqitj&page=' + page, {
					type: 'get',
					data: {},
					dataType: 'json',
					success: function(str) {

						crea('.uilist', str.data);

						function crea(id, data) {
							var list = new Creat_MQ({
								id: id,
								data: data,
							})
						}

					},
					error: function(xhr, type, errorThrown) {
						mui.toast('遇到问题，正在完善', {
							duration: 'short',
							type: 'div'
						});
					}
				})
			}
		}

		var sliderbox = document.querySelector('#slider');

		function lunbotu(data) {
			var result = '';
			var tar = data;
			var url = $$$.imgurl;
			result += '<div class="mui-slider-item"><a onclick="tiaozhuan(this)" data-id="' + tar[tar.length - 1]['cid'] + '"><img style="height:120px;" src="' + url + tar[tar.length - 1]['img'] + '" /></a></div>';
			result += '<div class="mui-slider-item"><a onclick="tiaozhuan(this)" data-id="' + tar[0]['cid'] + '"><img style="height:120px;" src="' + url + tar[0]['img'] + '" /></a></div>';
			for(var x = 1; x < tar.length - 1; x++) {
				result += '<div class="mui-slider-item"><a onclick="tiaozhuan(this)" data-id="' + tar[x]['cid'] + '"><img style="height:120px;" src="' + url + tar[x]['img'] + '" /></a></div>';
			}
			result += '<div class="mui-slider-item"><a onclick="tiaozhuan(this)" data-id="' + tar[tar.length - 1]['cid'] + '"><img style="height:120px;" src="' + url + tar[tar.length - 1]['img'] + '" /></a></div>';
			result += '<div class="mui-slider-item"><a onclick="tiaozhuan(this)" data-id="' + tar[0]['cid'] + '"><img style="height:120px;" src="' + url + tar[0]['img'] + '" /></a></div>';
			sliderbox.innerHTML = result;
			// 创建轮播图对象
			var gallery = mui('.mui-slider');
			gallery.slider({
				interval: 3000 //自动轮播周期，若为0则不自动播放，默认为0；
			});
		}

		function tiaozhuan(data) {
			//				var gosid = data.getAttribute('data-id');
			//				console.log(gosid);
			//				alert(gosid);return;
			//var cid = data.getAttribute('data-cid');
			gotolind(data)
		}

		function gotolind(t) {
			var gosid = t.getAttribute('data-id');
			localStorage.setItem('cid', gosid);
			mui.openWindow({
				url: '../../company/company.html',
				id: '../../company/company.html',
				extras: {

				},
				createNew: false, //是否重复创建同样id的webview，默认为false:不重复创建，直接显示
				waiting: {
					autoShow: true, //自动显示等待框，默认为true
				}
			})
			//mui.alert(gosid,'id');
		}
		//		var bg2 = document.querySelector('.bg2');
		//		alert(bg2.innerHTML)
	</script>

</html>